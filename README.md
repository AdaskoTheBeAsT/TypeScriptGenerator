# TypeScriptGenerator

This is sample proof of concept [SourceGenerator](https://devblogs.microsoft.com/dotnet/introducing-c-source-generators/) for generating TypeScript types.
Original idea was taken from [Typewriter recipes for angular](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes).

## Issues observed
1. .editorconfig file in root folder spoils source generator - I removed from top level
1. cmd line build doesn't work - only from VS
1. StreamWriter doesn't work but File.WriteAllText works :)
1. Only absolute path for generator works

## Enum samples

For now generator works for enums. It will be extended for model classes and for angular services based on asp net core controllers.
Enums are generated in web application in folder ```CLientApp/src/api/enums```

Sample enums generated.

1. Simple enum

    ```cs
        [TypeScriptGenerator.Include]
        public enum Sample1
        {
            First = 5,
            Second,
        }
    ```

    ```ts
        // Generated by https://github.com/AdaskoTheBeAsT/TypeScriptGenerator

        export enum Sample1 {
          First = 5,
          Second = 6,
        }

        export namespace Sample1 {

          export function getLabel(value: Sample1): string {
            switch(value) {
              case Sample1.First: return 'First';
              case Sample1.Second: return 'Second';
              default: throw new Error('Invalid value=`${value}`');
            }
          }

          export function getKeys(): string[] {
            const keys: string[] = [];
            for (let enumMember in Sample1) {
              if(!Sample1.hasOwnProperty(enumMember)) {
                continue;
              }
              if(isValidMember(enumMember)) {
                keys.push(Sample1[enumMember]);
              }
            }
            return keys;  
          }

          export function getValues(): Sample1[] {
            const values: Sample1[] = [];
            for (let enumMember in Sample1) {
              if(!Sample1.hasOwnProperty(enumMember)) {
                continue;
              }
              if(isValidMember(enumMember)) {
                values.push(enumMember);
              }        
            }
            return values;  
          }

          function isValidMember(value: any): value is number {
            return !isNaN(parseInt(value));
          }

        }
    ```

2. String enum - also showing different label

    ```cs
        [TypeScriptGenerator.Include]
        [TypeScriptGenerator.EnumAsString]
        public enum SampleText
        {
            [TypeScriptGenerator.EnumLabel("Zero")]
            One,
            Two,
        }
    ```

    ```ts
        // Generated by https://github.com/AdaskoTheBeAsT/TypeScriptGenerator

        export enum SampleText {
          One = 'One',
          Two = 'Two',
        }

        export namespace SampleText {

          export function getLabel(value: SampleText): string {
            switch(value) {
              case SampleText.One: return 'Zero';
              case SampleText.Two: return 'Two';
              default: throw new Error('Invalid value=`${value}`');
            }
          }

          export function getKeys(): string[] {
            const keys: string[] = [];
            for(let enumMember in SampleText) {
              if(!SampleText.hasOwnProperty(enumMember)) {
                continue;
              }
              if(!isValidMember(enumMember)){
                continue;
              }
              const member = SampleText[enumMember];
              if(typeof member === 'function'){
                continue;
              }
              keys.push(enumMember);
            } 
            return keys;
          }

          export function getValues(): SampleText[] {
            const values: SampleText[] = [];
            for (let enumMember in SampleText) {
              if(!SampleText.hasOwnProperty(enumMember)) {
                continue;
              }
              if (!isValidMember(enumMember)) {
                continue;
              }
              const member = SampleText[enumMember];
              if(typeof member === 'function'){
                continue;
              }
              values.push(member);
            }   
            return values;
          }

          function isValidMember(value: string): value is keyof typeof SampleText {
            return value in SampleText;
          }

        }
    ```

3. Flags - also showing different label (it cannot be combined with EnumAsString)

    ```cs
        [TypeScriptGenerator.Include]
        [Flags]
        public enum SampleThings
        {
            [TypeScriptGenerator.EnumLabel("Zero")]
            None = 0,
            FirstValue = 1,
            SecondValue = 1 << 1,
            ThirdValue = 1 << 2,
        }
    ```

    ```ts
        // Generated by https://github.com/AdaskoTheBeAsT/TypeScriptGenerator

        export enum SampleThings {
          None = 0,
          FirstValue = 1,
          SecondValue = 2,
          ThirdValue = 4,
        }

        export namespace SampleThings {

          export function getLabel(value: SampleThings): string {
            switch(value) {
              case SampleThings.None: return 'Zero';
              case SampleThings.FirstValue: return 'FirstValue';
              case SampleThings.SecondValue: return 'SecondValue';
              case SampleThings.ThirdValue: return 'ThirdValue';
              default: throw new Error('Invalid value=`${value}`');
            }
          }

          export function getKeys(): string[] {
            const keys: string[] = [];
            for (let enumMember in SampleThings) {
              if(!SampleThings.hasOwnProperty(enumMember)) {
                continue;
              }
              if(isValidMember(enumMember)) {
                keys.push(SampleThings[enumMember]);
              }
            }
            return keys;  
          }

          export function getValues(): SampleThings[] {
            const values: SampleThings[] = [];
            for (let enumMember in SampleThings) {
              if(!SampleThings.hasOwnProperty(enumMember)) {
                continue;
              }
              if(isValidMember(enumMember)) {
                values.push(enumMember);
              }        
            }
            return values;  
          }

          export function hasFlag(value: SampleThings, expected: SampleThings) {
            return (value && expected) === expected;
          }

          function isValidMember(value: any): value is number {
            return !isNaN(parseInt(value));
          }

        }
    ```